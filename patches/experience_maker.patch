--- /tmp/openrlhf_pkg/openrlhf_orig/openrlhf-0.9.3.data/purelib/openrlhf/trainer/ppo_utils/experience_maker.py	2026-02-05 12:33:06.000000000 +0000
+++ /opt/conda/envs/rft/lib/python3.10/site-packages/openrlhf/trainer/ppo_utils/experience_maker.py	2026-02-19 21:35:47.880970566 +0000
@@ -445,16 +445,26 @@
             "truncated": torch.tensor([is_truncated]),
         }
         if reward_val is not None:
-            info["reward"] = torch.tensor([reward_val])
+            try:
+                info["reward"] = torch.tensor([float(reward_val)])
+            except (ValueError, TypeError):
+                pass
         if score_val is not None:
-            info["score"] = torch.tensor([score_val])
+            try:
+                info["score"] = torch.tensor([float(score_val)])
+            except (ValueError, TypeError):
+                pass
 
         # Convert extra logs to tensors for downstream consumers.
         extra_logs = response.get("extra_logs", {})
         for key, value in extra_logs.items():
             if isinstance(value, torch.Tensor):
                 value = value.flatten()[0].item()
-            info[key] = torch.tensor([value])
+            if isinstance(value, (int, float)) and not isinstance(value, str):
+                try:
+                    info[key] = torch.tensor([float(value)])
+                except (ValueError, TypeError):
+                    pass  # skip non-convertible values
 
         return Experience(
             sequences=sequences.unsqueeze(0),
@@ -463,8 +473,8 @@
             rollout_log_probs=rollout_log_probs.unsqueeze(0) if rollout_log_probs is not None else None,
             prompts=[response["prompt"]],
             labels=[response["label"]],
-            rewards=torch.tensor([reward_val]) if reward_val is not None else None,
-            scores=torch.tensor([score_val]) if score_val is not None else None,
+            rewards=torch.tensor([float(reward_val)]) if reward_val is not None else None,
+            scores=torch.tensor([float(score_val)]) if score_val is not None else None,
             info=info,
         )
 
